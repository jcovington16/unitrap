"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.mutate = exports.prepareMutateOne = void 0;
const parser_js_1 = require("../helpers/parser.js");
const contract_js_1 = require("./contract.js");
async function prepareMutateOne({ statement, chainId, first, }) {
    const { tableId, prefix, chainId: chain } = await (0, parser_js_1.validateTableName)(first);
    (0, contract_js_1.assertChainId)(chain, chainId);
    return { tableId: tableId.toString(), statement, prefix, chainId };
}
exports.prepareMutateOne = prepareMutateOne;
async function mutate(config, params) {
    if (isMutateOne(params)) {
        return await _mutateOne(config, params);
    }
    return await _mutateMany(config, params);
}
exports.mutate = mutate;
async function _mutateOne({ signer }, { statement, tableId, chainId }) {
    const caller = await signer.getAddress();
    const { contract, overrides } = await (0, contract_js_1.getContractAndOverrides)(signer, chainId);
    return await contract["mutate(address,uint256,string)"](caller, tableId, statement, overrides);
}
async function _mutateMany({ signer }, { runnables, chainId }) {
    const caller = await signer.getAddress();
    const { contract, overrides } = await (0, contract_js_1.getContractAndOverrides)(signer, chainId);
    return await contract["mutate(address,(uint256,string)[])"](caller, runnables, overrides);
}
const isMutateOne = function (params) {
    return params.statement !== undefined;
};
//# sourceMappingURL=run.js.map