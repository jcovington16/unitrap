import { validateTableName } from "../helpers/parser.js";
import { getContractAndOverrides, assertChainId, } from "./contract.js";
export async function prepareMutateOne({ statement, chainId, first, }) {
    const { tableId, prefix, chainId: chain } = await validateTableName(first);
    assertChainId(chain, chainId);
    return { tableId: tableId.toString(), statement, prefix, chainId };
}
export async function mutate(config, params) {
    if (isMutateOne(params)) {
        return await _mutateOne(config, params);
    }
    return await _mutateMany(config, params);
}
async function _mutateOne({ signer }, { statement, tableId, chainId }) {
    const caller = await signer.getAddress();
    const { contract, overrides } = await getContractAndOverrides(signer, chainId);
    return await contract["mutate(address,uint256,string)"](caller, tableId, statement, overrides);
}
async function _mutateMany({ signer }, { runnables, chainId }) {
    const caller = await signer.getAddress();
    const { contract, overrides } = await getContractAndOverrides(signer, chainId);
    return await contract["mutate(address,(uint256,string)[])"](caller, runnables, overrides);
}
const isMutateOne = function (params) {
    return params.statement !== undefined;
};
//# sourceMappingURL=run.js.map